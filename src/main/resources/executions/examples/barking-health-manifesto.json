  {
  "dataset": {
    "subjects": [
      {
        "subjectType": "localAuthority",
        "provider": "uk.gov.ons"
        ,
        "matchRule": {
          "attribute": "label",
          "pattern": "E090000%"
        }
      }
    ],
    "datasources": [
      {
        "importerClass": "uk.org.tombolo.importer.ons.OaImporter",
        "datasourceId": "localAuthority"
      },
      {
        "importerClass": "uk.org.tombolo.importer.ons.OaImporter",
        "datasourceId": "englandGeneralisedBoundaries"
      },
      // The below contains the components of the subindex "Rate of regular physical activity higher than the East London average"
      // Note that two components from Active People Survey are pending
      {
        "importerClass": "uk.org.tombolo.importer.manifestohealth.MVPAImporter",
        "datasourceId": "MVPAactive"

      },
      // The below three datasets contain the components of subindex "Healthy weigh better than the East London average"
      {
        "importerClass": "uk.org.tombolo.importer.manifestohealth.NCMPImporter",
        "datasourceId": "childhoodObesity"

      },
      {
        "importerClass": "uk.org.tombolo.importer.manifestohealth.NHSAdmissionsImporter",
        "datasourceId": "NHSObese"

      },
      {
        "importerClass": "uk.org.tombolo.importer.manifestohealth.ObeseImporter",
        "datasourceId": "BMIObese"

      },
      // The below contains the components of the subindex "Personal wellbeing and happiness above the London average."
      {
        "importerClass": "uk.org.tombolo.importer.manifestohealth.ONSWellbeingImporter",
        "datasourceId": "ONSWellbeing"

      }
   ],
    // Derive decildecileses for the dataset that will be exported
    "fields": [
      {
        "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
        "label": "health_manifesto",
        "percentileCount": 10,
        "inverse": false,
        "valueField": {
          // Combine individual datasets using a LinearCombinationField with unity scalars.
          // The fields of the LinearCombinationField are the individual datasets
          "fieldClass": "uk.org.tombolo.field.transformation.LinearCombinationField",
          "label": "linear_combination",
          "scalars": [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1
          ],
          "fields": [
            {
              // Child obesity dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "PHE_child_obesity_Percentiles",
              "percentileCount": 10,
              "inverse": true,
              "valueField": {
                // Child obesity dataset. We are using BackOffField to deal with localAuthorities (subjects)
                // having no data. The BackOffField "fills" those localAuthorities with data resulting from a
                // geographical operation on a more generalised geometry (in this case englandGeneralisedBoundaries)
                // BackOffField takes a field of the dataset of interest and a MapToContainingSubjectField that maps
                // the resulting operation to that. The MapToContainingSubjectField contains the geographical operation
                // (in this case the mean value of all local authorities)
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "year6_excess_weight",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "year6_excess_weight",
                    "attribute": {
                      "provider": "uk.nhs.phe",
                      "label": "year6_excess_weight"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "year6_excess_weight",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "year6_excess_weight",
                        "attribute": {
                          "provider": "uk.nhs.phe",
                          "label": "year6_excess_weight"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // the PercentilesField takes the argument normalizationSubjects (see class reference)
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Intensity of physical activity dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "MVPA_active_Percentiles",
              "percentileCount": 10,
              "inverse": false,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "MVPA_active",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "MVPA_active",
                    "attribute": {
                      "provider": "activepeople.sportengland.org",
                      "label": "MVPA_active"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "MVPA_active",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "MVPA_active",
                        "attribute": {
                          "provider": "activepeople.sportengland.org",
                          "label": "MVPA_active"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Hospital admissions related to obesity dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "NHS_admissions_Percentiles",
              "percentileCount": 10,
              "inverse": true,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "admissions_all",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "admissions_all",
                    "attribute": {
                      "provider": "digital.nhs.uk",
                      "label": "admissions_all"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "admissions_all",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "admissions_all",
                        "attribute": {
                          "provider": "digital.nhs.uk",
                          "label": "admissions_all"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // Specification that determines that we calculate percentile boundaries nationally
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Body mass index that points to obesity dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "BMI_obese_Percentiles",
              "percentileCount": 10,
              "inverse": true,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "BMI_obesity",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "BMI_obesity",
                    "attribute": {
                      "provider": "activepeople.sportengland.org",
                      "label": "BMI_obesity"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "BMI_obesity",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "BMI_obesity",
                        "attribute": {
                          "provider": "activepeople.sportengland.org",
                          "label": "BMI_obesity"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // Specification that determines that we calculate percentile boundaries nationally
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Life satisfaction leveles dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "ONS_satisfaction_Percentiles",
              "percentileCount": 10,
              "inverse": false,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "life_satisfaction",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "life_satisfaction",
                    "attribute": {
                      "provider": "uk.gov.ons",
                      "label": "life_satisfaction"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "life_satisfaction",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "life_satisfaction",
                        "attribute": {
                          "provider": "uk.gov.ons",
                          "label": "life_satisfaction"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // Specification that determines that we calculate percentile boundaries nationally
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Life worthwhile levels dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "ONS_worthwhile_Percentiles",
              "percentileCount": 10,
              "inverse": false,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "worthwhile",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "worthwhile",
                    "attribute": {
                      "provider": "uk.gov.ons",
                      "label": "worthwhile"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "worthwhile",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "worthwhile",
                        "attribute": {
                          "provider": "uk.gov.ons",
                          "label": "worthwhile"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // Specification that determines that we calculate percentile boundaries nationally
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Life happiness levels dataset. We are using PercentilesField.
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "ONS_happy_Percentiles",
              "percentileCount": 10,
              "inverse": false,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "happy",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "happy",
                    "attribute": {
                      "provider": "uk.gov.ons",
                      "label": "happy"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "happy",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "happy",
                        "attribute": {
                          "provider": "uk.gov.ons",
                          "label": "happy"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // Specification that determines that we calculate percentile boundaries nationally
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            },
            {
              // Life axiety levels dataset. We are using PercentilesField. Greatest survival is good so we make it inverse
              "fieldClass": "uk.org.tombolo.field.transformation.PercentilesField",
              "label": "ONS_anxiety_Percentiles",
              "percentileCount": 10,
              "inverse": true,
              "valueField": {
                "fieldClass": "uk.org.tombolo.field.aggregation.BackOffField",
                "label": "anxiety",
                "fields": [
                  {
                    "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                    "label": "anxiety",
                    "attribute": {
                      "provider": "uk.gov.ons",
                      "label": "anxiety"
                    }
                  },
                  {
                    "fieldClass": "uk.org.tombolo.field.aggregation.MapToContainingSubjectField",
                    "subject": {
                      "provider": "uk.gov.ons",
                      "subjectType": "englandGeneralisedBoundaries"
                    },
                    "field": {
                      "fieldClass": "uk.org.tombolo.field.aggregation.GeographicAggregationField",
                      "label": "anxiety",
                      "subject": {
                        "provider": "uk.gov.ons",
                        "subjectType": "localAuthority"
                      },
                      "function": "mean",
                      "field": {
                        "fieldClass": "uk.org.tombolo.field.value.LatestValueField",
                        "label": "anxiety",
                        "attribute": {
                          "provider": "uk.gov.ons",
                          "label": "anxiety"
                        }
                      }
                    }
                  }
                ]
              },
              "normalizationSubjects": [
                // Specification that determines that we calculate percentile boundaries nationally
                {
                  "subjectType": "localAuthority",
                  "provider": "uk.gov.ons",
                  "matchRule": {
                    "attribute": "label",
                    "pattern": "E090000%"
                  }
                }
              ]
            }
          ]
        },
        "normalizationSubjects": [
          {
            "subjectType": "localAuthority",
            "provider": "uk.gov.ons",
            "matchRule": {
              "attribute": "label",
              "pattern": "E090000%"
            }
          }
        ]
      }
    ]

  },
    "exporter": "uk.org.tombolo.exporter.GeoJsonExporter",
    "timeStamp":false

}

    